MODULE COST_MODULE
IMPLICIT NONE


CONTAINS

! THE COST FUNCTION SHOULD BE INSERTED HERE

SUBROUTINE COST(N_DOUBLE, N_INT, N1, N2, CHROM_DOUBLE, CHROM_INT, FITNESS, ARRAY, G_CON, NCON)
IMPLICIT NONE
INTEGER, INTENT(IN) :: N_INT, N_DOUBLE, N1, N2, CHROM_INT(N_INT), NCON
DOUBLE PRECISION, INTENT(IN) :: CHROM_DOUBLE(N_DOUBLE)
DOUBLE PRECISION, INTENT(INOUT) :: FITNESS, G_CON(NCON), ARRAY(N1,N2)

DOUBLE PRECISION :: X(N_DOUBLE), SUM1, SUM2
INTEGER :: I, J, M
DOUBLE PRECISION :: alpha(30), a(30,30), b(30,30)
DOUBLE PRECISION :: AI(N_DOUBLE), BI(N_DOUBLE)

ARRAY(1,2)=ARRAY(1,2)+1.D0

alpha=array(2,:)
a=array(3:32,:)
b=array(33:62,:)

!OPEN(10, FILE="a.txt")
!OPEN(20, FILE="b.txt")
!OPEN(30, FILE="alpha.txt")

!DO I=1,30,1
!    READ(30,*) ALPHA(I)
!    READ(10,*) a(I,:)
!    READ(20,*) b(I,:)
!END DO
!CLOSE(10)
!CLOSE(20)
!CLOSE(30)



X=CHROM_DOUBLE

FITNESS=0.D0
DO I=1,N_DOUBLE, 1
    SUM1=0.D0
    SUM2=0.D0
    DO J=1,N_DOUBLE,1
        SUM1=SUM1+(a(I,J)*SIN(ALPHA(J))+b(I,J)*COS(ALPHA(J)))
        SUM2=SUM2+(a(I,J)*SIN(X(J))+b(I,J)*COS(X(J)))
    END DO
    AI(I)=SUM1
    BI(I)=SUM2
    FITNESS=FITNESS+(AI(I)-BI(I))**2
    !WRITE(*,*) I, FITNESS
END DO








END SUBROUTINE COST

END MODULE COST_MODULE
