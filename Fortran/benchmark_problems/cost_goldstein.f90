MODULE COST_MODULE
IMPLICIT NONE


CONTAINS

! THE COST FUNCTION SHOULD BE INSERTED HERE

SUBROUTINE COST(N_DOUBLE, N_INT, N1, N2, CHROM_DOUBLE, CHROM_INT, FITNESS, ARRAY, G_CON, NCON)
IMPLICIT NONE
INTEGER, INTENT(IN) :: N_INT, N_DOUBLE, N1, N2, CHROM_INT(N_INT), NCON
DOUBLE PRECISION, INTENT(IN) :: CHROM_DOUBLE(N_DOUBLE)
DOUBLE PRECISION, INTENT(INOUT) :: FITNESS, G_CON(NCON), ARRAY(N1,N2)

DOUBLE PRECISION :: X(N_DOUBLE), A, B
INTEGER :: I


ARRAY(1,2)=ARRAY(1,2)+1.D0

X=CHROM_DOUBLE
A=(1.D0+(X(1)+X(2)+1.D0)**2*(19.D0-14.D0*X(1)+3.D0*X(1)**2-14.D0*X(2)+6.D0*X(1)*X(2)+3.D0*X(2)**2))
B=(30.D0+(2.D0*X(1)-3.D0*X(2))**2*(18.D0-32.D0*X(1)+12.D0*X(1)**2+48.D0*X(2)-36.D0*X(1)*X(2)+27.D0*X(2)**2))
    
FITNESS=A*B

IF (ncon.gt.0) then
    g_con=-1.d0
end if

END SUBROUTINE COST

END MODULE COST_MODULE
