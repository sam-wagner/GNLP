MODULE COST_MODULE
IMPLICIT NONE


CONTAINS

! THE COST FUNCTION SHOULD BE INSERTED HERE

SUBROUTINE COST(N_DOUBLE, N_INT, N1, N2, CHROM_DOUBLE, CHROM_INT, FITNESS, ARRAY, G_CON, NCON)
IMPLICIT NONE
INTEGER, INTENT(IN) :: N_INT, N_DOUBLE, N1, N2, CHROM_INT(N_INT), NCON
DOUBLE PRECISION, INTENT(IN) :: CHROM_DOUBLE(N_DOUBLE)
DOUBLE PRECISION, INTENT(INOUT) :: FITNESS, G_CON(NCON), ARRAY(N1,N2)

DOUBLE PRECISION :: X(N_DOUBLE), SUM1, SUM2
INTEGER :: I, J, M
DOUBLE PRECISION :: C(10,4), B(10)

B(1)=0.1D0
B(2)=0.2D0
B(3)=0.2D0
B(4)=0.4D0
B(5)=0.4D0
B(6)=0.6D0
B(7)=0.3D0
B(8)=0.7D0
B(9)=0.5D0
B(10)=0.5D0

C(1,1)=4.D0
C(1,2)=4.D0
C(1,3)=4.D0
C(1,4)=4.D0
C(2,1)=1.D0
C(2,2)=1.D0
C(2,3)=1.D0
C(2,4)=1.D0
C(3,1)=8.D0
C(3,2)=8.D0
C(3,3)=8.D0
C(3,4)=8.D0
C(4,1)=6.D0
C(4,2)=6.D0
C(4,3)=6.D0
C(4,4)=6.D0
C(5,1)=3.D0
C(5,2)=7.D0
C(5,3)=3.D0
C(5,4)=7.D0
C(6,1)=2.D0
C(6,2)=9.D0
C(6,3)=2.D0
C(6,4)=9.D0
C(7,1)=5.D0
C(7,2)=3.D0
C(7,3)=5.D0
C(7,4)=3.D0
C(8,1)=8.D0
C(8,2)=1.D0
C(8,3)=8.D0
C(8,4)=1.D0
C(9,1)=6.D0
C(9,2)=2.D0
C(9,3)=6.D0
C(9,4)=2.D0
C(10,1)=7.D0
C(10,2)=3.D0
C(10,3)=7.D0
C(10,4)=3.D0



ARRAY(1,2)=ARRAY(1,2)+1.D0

X=CHROM_DOUBLE


M=10
SUM1=0.D0
DO I=1,M,1
    SUM2=0.D0
    DO J=1,N_DOUBLE,1
        SUM2=SUM2+(X(J)-C(I,J))**2
    END DO
    SUM1=SUM1+1.D0/(SUM2+B(I))
END DO
FITNESS=-SUM1+15.d0




END SUBROUTINE COST

END MODULE COST_MODULE
